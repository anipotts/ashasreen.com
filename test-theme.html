<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theme Toggle Test</title>
    <style>
        /* Mirror the exact CSS from globals.css */
        :root {
            --color-primary: #f26959;
            --color-primary-dark: #d9574a;
            --color-secondary: #C65D3B;
            --color-secondary-dark: #A34D30;
            --color-accent: #7D8471;
            --color-neutral-dark: #2D2D2D;
            --color-neutral-light: #FAF7F2;
            --color-neutral-medium: #E8E4DD;
            --background: #FAF7F2;
            --foreground: #2D2D2D;
        }

        .dark {
            --background: #1A1A1A;
            --foreground: #F5F5F5;
            --color-neutral-light: #242424;
            --color-neutral-medium: #3D3D3D;
            --color-neutral-dark: #F5F5F5;
        }

        body {
            background: var(--background);
            color: var(--foreground);
            font-family: system-ui, sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
            margin: 0;
            padding: 2rem;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            color: var(--color-primary);
            margin-bottom: 2rem;
        }

        .test-section {
            background: var(--color-neutral-light);
            padding: 2rem;
            margin: 1rem 0;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }

        .info-item {
            padding: 1rem;
            background: var(--color-neutral-medium);
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        .info-item strong {
            color: var(--color-primary);
        }

        button {
            background: var(--color-primary);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.2s;
            margin: 1rem 0;
        }

        button:hover {
            background: var(--color-primary-dark);
        }

        .status {
            padding: 1rem;
            background: var(--color-neutral-medium);
            border-radius: 4px;
            margin: 1rem 0;
            font-family: monospace;
        }

        .success {
            color: #4CAF50;
        }

        .warning {
            color: #FF9800;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Theme Toggle Test Page</h1>

        <div class="test-section">
            <h2>Current Theme Status</h2>
            <div id="currentStatus" class="status"></div>

            <button id="toggleBtn" onclick="toggleTheme()">Toggle Theme</button>
            <button onclick="clearStorage()">Clear Storage (Reset)</button>
        </div>

        <div class="test-section">
            <h2>CSS Variables Test</h2>
            <div class="info-grid">
                <div class="info-item">
                    <strong>Background:</strong>
                    <div id="bgValue"></div>
                </div>
                <div class="info-item">
                    <strong>Foreground:</strong>
                    <div id="fgValue"></div>
                </div>
                <div class="info-item">
                    <strong>Neutral Light:</strong>
                    <div id="nlValue"></div>
                </div>
                <div class="info-item">
                    <strong>Neutral Medium:</strong>
                    <div id="nmValue"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>Test Results</h2>
            <div id="testResults"></div>
        </div>
    </div>

    <script>
        // Mirror the exact logic from ThemeToggle.tsx and layout.tsx

        function getInitialTheme() {
            const savedTheme = localStorage.getItem('theme');
            return savedTheme || 'light';
        }

        function applyThemeToDOM(theme) {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        function toggleTheme() {
            const currentTheme = getInitialTheme();
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            localStorage.setItem('theme', newTheme);
            applyThemeToDOM(newTheme);
            updateStatus();
            runTests();
        }

        function clearStorage() {
            localStorage.removeItem('theme');
            applyThemeToDOM('light');
            updateStatus();
            runTests();
        }

        function getCSSVariable(name) {
            return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
        }

        function updateStatus() {
            const theme = getInitialTheme();
            const hasDarkClass = document.documentElement.classList.contains('dark');
            const bg = getCSSVariable('--background');
            const fg = getCSSVariable('--foreground');

            document.getElementById('currentStatus').innerHTML = `
                <strong>Saved Theme:</strong> ${theme}<br>
                <strong>Dark Class:</strong> ${hasDarkClass}<br>
                <strong>Icon Should Show:</strong> ${theme === 'dark' ? 'Sun ‚òÄÔ∏è' : 'Moon üåô'}
            `;

            document.getElementById('bgValue').textContent = bg;
            document.getElementById('fgValue').textContent = fg;
            document.getElementById('nlValue').textContent = getCSSVariable('--color-neutral-light');
            document.getElementById('nmValue').textContent = getCSSVariable('--color-neutral-medium');
        }

        function runTests() {
            const theme = getInitialTheme();
            const hasDarkClass = document.documentElement.classList.contains('dark');
            const bg = getCSSVariable('--background');
            const fg = getCSSVariable('--foreground');

            const results = [];

            // Test 1: Theme matches class
            if ((theme === 'dark' && hasDarkClass) || (theme === 'light' && !hasDarkClass)) {
                results.push('<div class="success">‚úì Theme matches DOM class</div>');
            } else {
                results.push('<div class="warning">‚úó Theme/class mismatch!</div>');
            }

            // Test 2: Light mode colors
            if (theme === 'light') {
                if (bg === 'rgb(250, 247, 242)' || bg === '#FAF7F2') {
                    results.push('<div class="success">‚úì Light mode background correct</div>');
                } else {
                    results.push('<div class="warning">‚úó Light mode background wrong: ' + bg + '</div>');
                }
            }

            // Test 3: Dark mode colors
            if (theme === 'dark') {
                if (bg === 'rgb(26, 26, 26)' || bg === '#1A1A1A') {
                    results.push('<div class="success">‚úì Dark mode background correct</div>');
                } else {
                    results.push('<div class="warning">‚úó Dark mode background wrong: ' + bg + '</div>');
                }
            }

            // Test 4: localStorage
            const storedTheme = localStorage.getItem('theme');
            if (storedTheme === theme || (storedTheme === null && theme === 'light')) {
                results.push('<div class="success">‚úì localStorage synchronized</div>');
            } else {
                results.push('<div class="warning">‚úó localStorage mismatch!</div>');
            }

            document.getElementById('testResults').innerHTML = results.join('');
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            const theme = getInitialTheme();
            applyThemeToDOM(theme);
            updateStatus();
            runTests();
        });
    </script>
</body>
</html>
